id: ncjt_knobs
label: Knobs
category: '[dMIMO]'
flags: [ show_id, python ]

templates:
  imports: from gnuradio import ncjt
  make: ncjt.knobs(${mcs}, ${phase1_modtype}, ${phase2_modtype}, ${phase3_modtype}, ${code_rate}, ${reset}, ${noair})

parameters:
- id: mcs
  label: Show MCS controls
  dtype: bool
  default: 'True'
  options: [ 'True', 'False' ]
  option_labels: [ Enable, Disable ]
- id: phase1_modtype
  label: Phase 1 Bits per Symbol
  dtype: int
  default: 2
  options: [2, 4, 6, 8]
  option_labels: [ QPSK, 16QAM, 64QAM, 256QAM ]
  hide: ${ 'all' if not mcs else 'none' }
- id: phase2_modtype
  label: Phase 2 Bits per Symbol
  dtype: int
  default: 2
  options: [2, 4, 6, 8]
  option_labels: [ QPSK, 16QAM, 64QAM, 256QAM ]
  hide: ${ 'all' if not mcs else 'none' }
- id: phase3_modtype
  label: Phase 3 Bits per Symbol
  dtype: int
  default: 2
  options: [2, 4, 6, 8]
  option_labels: [ QPSK, 16QAM, 64QAM, 256QAM ]
  hide: ${ 'all' if not mcs else 'none' }
- id: code_rate
  label: Code Rate
  dtype: int
  default: 0
  options: [0, 1, 2, 3, 4, 5, 6, 7]
  option_labels: [ 'Disable', '1/4', '1/3', '1/2', '2/3', '3/4', '4/5', '5/6' ]
  hide: ${ 'all' if not mcs else 'none' }
- id: reset
  label: Show Reset Stats control
  dtype: bool
  default: 'True'
  options: [ 'True', 'False' ]
  option_labels: [ Enable, Disable ]
- id: noair
  label: Show NoAir controls
  dtype: bool
  default: 'False'
  options: [ 'True', 'False' ]
  option_labels: [ Enable, Disable ]
- id: gui_hint
  label: GUI Hint
  dtype: gui_hint
  hide: part

inputs: []

outputs:
- label: s_modtypes
  domain: message
  optional: true
  hide: ${ not mcs }
- label: s_code_rate
  domain: message
  optional: true
  hide: ${ not mcs }
- label: s_snr
  domain: message
  optional: true
  hide: ${ not noair }
- label: reset
  domain: message
  optional: true
  hide: ${ not reset }


templates:
    imports: from gnuradio.ncjt import knobs
    var_make: self.${id} = None
    make: |-
        <%
            win = '_%s_knobs'%id
        %>\
        ${win} = knobs(
            ${mcs},
            ${phase1_modtype},
            ${phase2_modtype},
            ${phase3_modtype},
            ${code_rate},
            ${reset},
            ${noair}
        )
        self.${id} = ${win}
        ${gui_hint() % win} 

file_format: 1
